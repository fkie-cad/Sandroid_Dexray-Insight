# Dexray Insight Configuration File
# This file contains configuration settings for API keys and analysis parameters

# Signature Detection API Configuration
# Replace "YOUR_API_KEY" with your actual API keys from the respective services

# Analysis Configuration
analysis:
  parallel_execution:
    enabled: true
    max_workers: 4
  timeout:
    module_timeout: 300  # 5 minutes per module
    tool_timeout: 600    # 10 minutes per tool

# Module Configuration
modules:
  signature_detection:
    enabled: true
    priority: 10
    providers:
      virustotal:
        enabled: false
        api_key: "YOUR_VIRUSTOTAL_API_KEY"
        rate_limit: 4  # requests per minute for free tier
        
      koodous:
        enabled: false
        api_key: "YOUR_KOODOUS_API_KEY"
        
      triage:
        enabled: false
        api_key: "YOUR_TRIAGE_API_KEY"
    
  permission_analysis:
    enabled: true
    priority: 20
    critical_permissions_file: null  # Path to custom permissions file
    use_default_critical_list: true
    
  string_analysis:
    enabled: true
    priority: 30
    patterns:
      ip_addresses: true
      urls: true
      email_addresses: true
      domains: true
      base64_strings: true
    filters:
      min_string_length: 2
      exclude_patterns: []  # No exclusion patterns by default
      
  api_invocation:
    enabled: true
    priority: 40
    reflection_analysis: true
    
  manifest_analysis:
    enabled: true
    priority: 15
    extract_intent_filters: true
    analyze_exported_components: true
    
  apk_diffing:
    enabled: false
    priority: 100
    
  tracker_analysis:
    enabled: true
    priority: 35
    fetch_exodus_trackers: true
    exodus_api_url: "https://reports.exodus-privacy.eu.org/api/trackers"
    api_timeout: 10
    
  deep_analysis:
    enabled: false
    priority: 1000  # Lowest priority to run last
    features:
      device_model_access: true
      imei_access: true
      android_version_access: true
      phone_number_access: true
      clipboard_usage: true
      dynamic_receivers: true
      camera_access: true
      running_services_access: true
      installed_applications_access: true
      installed_packages_access: true
      reflection_usage: true

# External Tools Configuration
tools:
  apkid:
    enabled: true
    timeout: 300
    options: []
    
  kavanoz:
    enabled: true
    timeout: 600
    output_dir: null  # If null, uses temp directory
    
  androguard:
    enabled: true
    logging_level: "WARNING"

# Security Assessment Configuration
security:
  enable_owasp_assessment: true
  assessments:
    injection:
      enabled: true
      sql_patterns: ["SELECT", "INSERT", "UPDATE", "DELETE", "DROP"]
      command_patterns: ["exec", "system", "runtime"]
    broken_authentication:
      enabled: true
      check_weak_crypto: true
      check_hardcoded_secrets: true
    sensitive_data:
      enabled: true
      pii_patterns: ["email", "phone", "ssn", "credit_card"]
      crypto_keys_check: true
      # Enhanced hardcoded key detection settings
      key_detection:
        enabled: true
        # Detection patterns to enable/disable
        patterns:
          pem_keys: true              # PEM formatted private keys and certificates
          ssh_keys: true              # SSH public/private keys
          jwt_tokens: true            # JWT tokens
          api_keys: true              # Various API keys (AWS, GitHub, Google, etc.)
          base64_keys: true           # Base64 encoded potential keys
          hex_keys: true              # Hexadecimal keys
          database_connections: true  # Database connection strings
          high_entropy_strings: true  # Generic high-entropy strings
        # Entropy thresholds for detection
        entropy_thresholds:
          min_base64_entropy: 4.0     # Minimum entropy for base64 strings
          min_hex_entropy: 3.5        # Minimum entropy for hex strings  
          min_generic_entropy: 5.0    # Minimum entropy for generic strings
        # String length filters
        length_filters:
          min_key_length: 16          # Minimum length for potential keys
          max_key_length: 512         # Maximum length to avoid very long strings
        # Context detection settings
        context_detection:
          enabled: true               # Enable context-aware detection
          strict_mode: false          # Require context for all detections
    broken_access_control:
      enabled: true
      check_exported_components: true
      check_permissions: true
    security_misconfiguration:
      enabled: true
      check_debug_flags: true
      check_network_security: true
    vulnerable_components:
      enabled: true
      check_known_libraries: true
    insufficient_logging:
      enabled: true
      check_logging_practices: true

# Output Configuration
output:
  format: "json"
  pretty_print: true
  include_timestamps: true
  output_directory: "./results"
  filename_template: "dexray_{apk_name}_{timestamp}.json"

# Logging Configuration
logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: null  # If null, logs to console only